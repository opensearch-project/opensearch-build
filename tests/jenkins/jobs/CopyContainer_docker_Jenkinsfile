pipeline {
    agent none
    stages {
        stage('copyImage') {
            steps {
                script {
                    copyContainer(
                        sourceImagePath: 'opensearchstaging/ci-runner:latest',
                        destinationImagePath: 'opensearchproject/ci-runner:latest',
                        destinationType: 'docker',
                        destinationCredentialIdentifier: 'jenkins-staging-docker-prod-token'
                    )

                    copyContainer(
                        sourceImagePath: 'opensearchstaging/ci-runner:latest',
                        destinationImagePath: 'public.ecr.aws/opensearchstaging/ci-runner:latest',
                        destinationType: 'ecr',
                        ecrProd: false,
                        destinationCredentialIdentifier: 'public.ecr.aws/opensearchstaging',
                    )

                    copyContainer(
                        sourceImagePath: 'opensearchstaging/ci-runner:latest',
                        destinationImagePath: 'public.ecr.aws/opensearchproject/ci-runner:latest',
                        destinationType: 'ecr',
                        ecrProd: true,
                        destinationCredentialIdentifier: 'public.ecr.aws/opensearchproject',
                    )
                }
            }
        }
    }
}
